{% extends "base.html" %}

{% block title %}{{ service.name }} - DownDetector Clone{% endblock %}

{% block content %}
<div class="container">
    <!-- Service Header -->
    <div class="text-center py-5">
        {% if service.icon_path %}
        <div class="mb-4">
            <div class="service-icon d-inline-block" style="width: 80px; height: 80px; background: 
                {% if service.name == 'Twitter' %}#1DA1F2
                {% elif service.name == 'YouTube' %}#FF0000
                {% elif service.name == 'TikTok' %}#000000
                {% elif service.name == 'Instagram' %}#E4405F
                {% elif service.name == 'Facebook' %}#1877F2
                {% elif service.name == 'LinkedIn' %}#0077B5
                {% elif service.name == 'WhatsApp' %}#25D366
                {% elif service.name == 'Snapchat' %}#FFFC00
                {% elif service.name == 'Discord' %}#5865F2
                {% elif service.name == 'Reddit' %}#FF4500
                {% elif service.name == 'Spotify' %}#1DB954
                {% elif service.name == 'Gmail' %}#EA4335
                {% else %}#5DADE2{% endif %}; border-radius: 16px;">
                <img src="{{ url_for('static', filename=service.icon_path) }}" 
                     alt="{{ service.name }} logo" 
                     style="width: 40px; height: 40px; object-fit: contain; {% if service.name != 'Snapchat' %}filter: brightness(0) invert(1);{% endif %}">
            </div>
        </div>
        {% endif %}
        
        <h1 style="font-size: 1.8rem; color: var(--text-dark); margin-bottom: 1rem;">{{ service.name }}</h1>
        
        <p class="text-muted mb-4" style="font-size: 1rem; max-width: 600px; margin: 0 auto;">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc vulputate
            libero et velit interdum, ac aliquet odio mattis.
        </p>
        
        <!-- Action Buttons -->
        <div class="mb-5">
            <button type="button" class="btn btn-danger me-2 mb-2" data-bs-toggle="modal" data-bs-target="#reportModal" style="border-radius: 5px;">
                Signaler la panne
            </button>
            <button type="button" class="btn btn-danger me-2 mb-2" style="border-radius: 5px;">
                Vérifier statut
            </button>
            <button type="button" class="btn btn-danger me-2 mb-2" style="border-radius: 5px;">
                Signaler fiable
            </button>
            <button type="button" class="btn btn-secondary mb-2" style="border-radius: 5px;">
                Autre chose
            </button>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- 24 Hour Chart Section -->
            <div class="mb-5">
                <div class="card border-0 shadow-sm">
                    <div class="card-body" style="min-height: 350px; padding: 2rem;">
                        <canvas id="reportsChart" style="max-height: 300px;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Locations and Problems Section -->
            <div class="mb-5">
                <h4 class="mb-4" style="font-weight: 600; color: var(--text-dark);">Emplacements les plus fréquemment signalés</h4>
                
                <div class="row mb-4">
                    <div class="col-md-4 mb-2">
                        <span class="badge bg-danger" style="font-size: 0.9rem; padding: 0.5rem 1rem;">Tlemcen</span>
                    </div>
                    <div class="col-md-4 mb-2">
                        <span class="badge bg-danger" style="font-size: 0.9rem; padding: 0.5rem 1rem;">Fès, Meknès</span>
                    </div>
                    <div class="col-md-4 mb-2">
                        <span class="badge bg-danger" style="font-size: 0.9rem; padding: 0.5rem 1rem;">Annaba</span>
                    </div>
                    <div class="col-md-4 mb-2">
                        <span class="badge bg-danger" style="font-size: 0.9rem; padding: 0.5rem 1rem;">Rabat</span>
                    </div>
                    <div class="col-md-4 mb-2">
                        <span class="badge bg-danger" style="font-size: 0.9rem; padding: 0.5rem 1rem;">Casablanca</span>
                    </div>
                    <div class="col-md-4 mb-2">
                        <span class="badge bg-danger" style="font-size: 0.9rem; padding: 0.5rem 1rem;">Tanger</span>
                    </div>
                    <div class="col-md-4 mb-2">
                        <span class="badge bg-danger" style="font-size: 0.9rem; padding: 0.5rem 1rem;">Oujda</span>
                    </div>
                </div>
                
                <h4 class="mb-4 mt-5" style="font-weight: 600; color: var(--text-dark);">Problèmes les plus signalés</h4>
                
                <div class="row mb-5">
                    <div class="col-md-4 mb-3">
                        <div class="p-3 bg-light rounded">
                            <h6>Internet mobile</h6>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="p-3 bg-light rounded">
                            <h6>Internet Fixe</h6>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="p-3 bg-light rounded">
                            <h6>Blackout total</h6>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Comment Section -->
            <div class="mb-5">
                <div class="card border-0 shadow-sm">
                    <div class="card-body" style="padding: 2rem;">
                        <div class="form-group mb-3">
                            <textarea class="form-control" rows="4" placeholder="Ajouter un commentaire..."
                                    style="border: 1px solid #dee2e6; border-radius: 8px; font-size: 0.95rem;"></textarea>
                        </div>
                        <div class="text-end">
                            <button class="btn btn-yellow" style="padding: 0.5rem 2rem;">
                                Publier
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Report Modal -->
<div class="modal fade" id="reportModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Report Issue with {{ service.name }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form id="reportForm">
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="location" class="form-label">Location (Optional)</label>
                        <input type="text" class="form-control" id="location" placeholder="e.g., New York, USA">
                    </div>
                    <div class="mb-3">
                        <label for="description" class="form-label">Problem Description</label>
                        <textarea class="form-control" id="description" rows="3" 
                                placeholder="Describe the issue you're experiencing..." required></textarea>
                    </div>
                    <div class="mb-3">
                        <button type="button" class="btn btn-outline-secondary btn-sm" id="getLocationBtn">
                            <i data-feather="map-pin" class="me-1"></i>
                            Use My Location
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Submit Report</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    const SERVICE_ID = {{ service.id }};
    const SERVICE_NAME = "{{ service.name }}";
</script>
<script src="{{ url_for('static', filename='js/service-detail.js') }}"></script>
{% endblock %}
